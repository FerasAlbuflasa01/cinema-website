<%- include("../partials/_navbar") %>

<h1>Edit Your Profile</h1>

<form
  action="/auth/edit?_method=PUT"
  method="POST"
  enctype="multipart/form-data"
>
  <label>First Name:</label>
  <input type="text" name="firstName" value="<%= user.firstName %>" />
  <br />

  <label>Last Name:</label>
  <input type="text" name="lastName" value="<%= user.lastName %>" />
  <br />

  <label>Email:</label>
  <input type="email" name="email" value="<%= user.email %>" />
  <br />

  <label for="profilePic">Change Profile Picture:</label>
  <input type="file" name="profilePic" id="profilePic" accept="image/*" /><br />

  <img
    id="preview"
    src="<%= user.profilePic ? `/uploads/${user.profilePic}` : '/images/default-avatar.png' %>"
    width="100"
    style="display: block"
  />

  <br />

  <h3>Change Password</h3>
  <label>Current Password:</label>
  <input type="password" name="currentPassword" />
  <br />

  <label>New Password:</label>
  <input type="password" name="newPassword" />
  <br />

  <button type="submit">Update Profile</button>
</form>

<script>
  const fileInput = document.getElementById('profilePic')
  const previewImage = document.getElementById('preview')

  fileInput.addEventListener('change', function () {
    const file = this.files[0]
    if (file) {
      const reader = new FileReader()
      reader.onload = function (e) {
        previewImage.src = e.target.result
      }
      reader.readAsDataURL(file)
    }
  })
</script>
